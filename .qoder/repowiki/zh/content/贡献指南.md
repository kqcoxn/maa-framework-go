# 贡献指南

<cite>
**本文档引用的文件**  
- [README.md](file://README.md)
- [README_zh.md](file://README_zh.md)
- [go.mod](file://go.mod)
- [main_test.go](file://main_test.go)
- [controller_test.go](file://controller_test.go)
- [context_test.go](file://context_test.go)
- [job_test.go](file://job_test.go)
- [pipeline_test.go](file://pipeline_test.go)
- [test/main_test.go](file://test/main_test.go)
- [examples/quick-start/main.go](file://examples/quick-start/main.go)
- [examples/custom-action/main.go](file://examples/custom-action/main.go)
- [examples/custom-recognition/main.go](file://examples/custom-recognition/main.go)
- [tools/gen-event-sink/main.go](file://tools/gen-event-sink/main.go)
</cite>

## 目录
1. [简介](#简介)
2. [报告 Bug](#报告-bug)
3. [提出新功能建议](#提出新功能建议)
4. [代码贡献流程](#代码贡献流程)
5. [代码风格与格式要求](#代码风格与格式要求)
6. [测试要求](#测试要求)
7. [文档更新规范](#文档更新规范)
8. [沟通渠道](#沟通渠道)
9. [总结](#总结)

## 简介

欢迎为 MaaFramework Go 绑定项目做出贡献！本项目旨在为 [MaaFramework](https://github.com/MaaXYZ/MaaFramework) 提供一个纯 Go 语言的绑定，支持跨平台自动化测试，基于图像识别技术实现对 Android 和 Windows 应用的自动化控制。

本贡献指南旨在为社区成员提供清晰、友好的指引，帮助您顺利地参与到项目的开发中来。无论您是想报告一个 Bug、提出功能建议，还是直接提交代码，都可以在这里找到详细的流程和规范。

我们高度重视代码质量和可维护性，鼓励所有贡献者遵循统一的代码风格和测试标准。通过您的参与，我们可以共同打造一个更强大、更稳定的自动化框架。

**Section sources**
- [README.md](file://README.md#L1-L169)
- [README_zh.md](file://README_zh.md#L1-L169)

## 报告 Bug

当您在使用 MaaFramework Go 绑定时遇到问题，我们鼓励您通过 GitHub Issues 报告 Bug。一份清晰、完整的 Bug 报告有助于维护者快速定位和解决问题。

请在提交 Issue 时提供以下信息：

- **环境信息**：操作系统（Windows/Linux/macOS）、Go 版本、MaaFramework 版本。
- **问题描述**：清晰地描述您遇到的问题，包括错误发生的具体场景。
- **复现步骤**：详细列出能够稳定复现该问题的操作步骤。
- **预期行为**：说明您期望程序应该如何运行。
- **实际行为**：描述程序实际表现出的行为。
- **错误日志**：如果可能，请提供相关的错误日志或堆栈跟踪信息。您可以通过设置 `WithLogDir` 选项来启用日志记录。
- **示例代码**：提供一段能够复现问题的最小化代码片段。

您可以在 [GitHub Issues](https://github.com/MaaXYZ/maa-framework-go/issues) 页面创建新的 Issue。请确保在提交前搜索是否已有类似的问题，以避免重复。

**Section sources**
- [README.md](file://README.md#L153-L157)
- [README_zh.md](file://README_zh.md#L153-L157)

## 提出新功能建议

我们非常欢迎社区成员提出新功能的建议或改进意见。在提交功能请求前，请先查阅项目的 [文档](https://pkg.go.dev/github.com/MaaXYZ/maa-framework-go/v3) 和现有的 [Issues](https://github.com/MaaXYZ/maa-framework-go/issues) 以及 [Discussions](https://github.com/MaaXYZ/MaaFramework/discussions)，确认该功能尚未被提出或实现。

提交功能建议时，请尽量提供以下信息：

- **功能描述**：清晰地描述您希望添加的功能。
- **使用场景**：说明该功能将如何被使用，解决什么问题。
- **API 设计建议**（可选）：如果您有具体的设计想法，可以提供 API 的使用示例。
- **相关参考**（可选）：提供类似功能的参考链接或实现。

您可以通过创建一个新的 GitHub Issue 或在 GitHub Discussions 中发起讨论来提出您的建议。

**Section sources**
- [README.md](file://README.md#L158-L159)
- [README_zh.md](file://README_zh.md#L158-L159)

## 代码贡献流程

我们非常欢迎通过 Pull Request (PR) 提交代码贡献。以下是完整的代码贡献流程：

### 1. Fork 仓库
首先，在 GitHub 上 Fork `maa-framework-go` 仓库到您自己的账户。

### 2. 创建分支
在您的本地 Fork 仓库中，创建一个新的特性分支。请使用清晰、有意义的分支名称，例如 `feature/add-new-controller` 或 `fix/bug-in-pipeline`。

```bash
git clone https://github.com/your-username/maa-framework-go.git
cd maa-framework-go
git checkout -b feature/your-feature-name
```

### 3. 进行修改
在您的分支上进行代码修改。请确保您的修改符合项目的代码风格和测试要求。

### 4. 提交更改
使用 `git add` 和 `git commit` 提交您的更改。提交信息应清晰、简洁，描述本次更改的目的。

```bash
git add .
git commit -m "Add new feature: brief description"
```

### 5. 推送分支
将您的分支推送到您 Fork 的远程仓库。

```bash
git push origin feature/your-feature-name
```

### 6. 创建 Pull Request
访问 GitHub 上您 Fork 的仓库页面，您会看到一个提示创建 Pull Request 的按钮。点击该按钮，向 `maa-framework-go` 的主仓库提交 PR。

在 PR 描述中，请详细说明您所做的更改、解决的问题或添加的功能。如果 PR 解决了某个 Issue，请在描述中使用 `Fixes #123` 格式关联该 Issue。

维护者会审查您的代码，可能会提出修改建议。请根据反馈进行相应的调整。

**Section sources**
- [README.md](file://README.md#L159-L160)
- [README_zh.md](file://README_zh.md#L159-L160)

## 代码风格与格式要求

为了保持代码库的一致性和可读性，本项目遵循 Go 语言的通用代码风格和格式规范。

- **格式化**：所有 Go 代码必须使用 `gofmt` 或 `goimports` 进行格式化。在提交代码前，请运行 `go fmt ./...` 确保代码格式正确。
- **命名规范**：遵循 Go 的命名约定，使用驼峰式命名法（CamelCase）。包名应简洁、小写。
- **注释**：为公共的结构体、函数和方法添加清晰的注释，说明其用途和参数。注释应使用英文。
- **代码生成**：项目中包含代码生成工具（如 `tools/gen-event-sink`），用于生成事件 Sink 相关的代码。如果您需要修改此类代码，请修改生成器模板，然后重新运行生成命令，而不是直接编辑生成的文件。

遵循这些规范有助于提高代码的可维护性，并使代码审查过程更加高效。

**Section sources**
- [tools/gen-event-sink/main.go](file://tools/gen-event-sink/main.go#L1-L154)

## 测试要求

高质量的测试是保证代码稳定性的关键。我们要求所有代码贡献都必须包含相应的测试。

### 如何编写单元测试
- **测试覆盖率**：尽可能提高测试覆盖率，特别是对核心功能和公共 API。
- **测试结构**：遵循 Go 的测试惯例，测试文件以 `_test.go` 结尾，测试函数以 `Test` 开头。
- **测试断言**：使用 `github.com/stretchr/testify/require` 包进行断言，它能提供更清晰的错误信息。
- **测试初始化**：对于需要全局初始化的测试，可以在 `main_test.go` 文件中使用 `TestMain` 函数进行设置。

### 如何运行单元测试
要运行项目的全部测试，请在项目根目录下执行以下命令：

```bash
go test ./...
```

您也可以运行特定包的测试：

```bash
go test ./controller
```

在提交 PR 前，请确保所有测试都能通过。CI/CD 系统会在 PR 提交后自动运行测试。

**Section sources**
- [main_test.go](file://main_test.go#L1-L17)
- [test/main_test.go](file://test/main_test.go#L1-L19)
- [controller_test.go](file://controller_test.go#L1-L220)
- [context_test.go](file://context_test.go#L1-L800)
- [job_test.go](file://job_test.go#L1-L414)
- [pipeline_test.go](file://pipeline_test.go#L1-L101)

## 文档更新规范

当您添加新功能或修改现有功能时，请务必同步更新相关文档。

- **代码注释**：确保所有公共 API 都有清晰的注释。
- **README 更新**：如果您的更改影响了项目的使用方式（如新增 API、修改配置等），请更新 `README.md` 和 `README_zh.md` 文件中的示例代码和说明。
- **示例代码**：考虑在 `examples` 目录下添加新的示例，以展示新功能的使用方法。
- **API 文档**：项目的 API 文档由 [pkg.go.dev](https://pkg.go.dev/github.com/MaaXYZ/maa-framework-go/v3) 自动生成，因此只需确保代码注释准确即可。

良好的文档是项目成功的关键，它能帮助新用户快速上手，也能让其他开发者更容易理解您的代码。

**Section sources**
- [README.md](file://README.md#L1-L169)
- [README_zh.md](file://README_zh.md#L1-L169)
- [examples/quick-start/main.go](file://examples/quick-start/main.go#L1-L41)
- [examples/custom-action/main.go](file://examples/custom-action/main.go#L1-L49)
- [examples/custom-recognition/main.go](file://examples/custom-recognition/main.go#L1-L77)

## 沟通渠道

我们提供了多种渠道供社区成员与维护者沟通：

- **GitHub Discussions**：用于讨论项目发展方向、提出设计建议或进行技术交流。[MaaFramework Discussions](https://github.com/MaaXYZ/MaaFramework/discussions)
- **QQ 群**：提供中文社区支持，您可以加入 QQ 群 595990173 与其他用户和开发者交流。
- **GitHub Issues**：用于报告 Bug 和提交功能请求。

我们鼓励在公开渠道进行讨论，这样可以让更多人受益，并促进社区的健康发展。

**Section sources**
- [README.md](file://README.md#L165-L168)
- [README_zh.md](file://README_zh.md#L165-L168)

## 总结

感谢您阅读这份贡献指南！我们相信，通过社区的共同努力，MaaFramework Go 绑定项目将变得越来越强大。无论您的贡献大小，我们都表示由衷的感谢。

请记住，贡献不仅仅是代码。报告 Bug、提出建议、编写文档、帮助其他用户，这些都是非常有价值的贡献。

现在，就让我们一起开始吧！Fork 仓库，创建您的第一个 Issue 或 Pull Request，成为 MaaFramework 社区的一员。